[gd_scene load_steps=26 format=3 uid="uid://ccxc1q7qwg4j6"]

[ext_resource type="Script" uid="uid://dld20h80s6t7l" path="res://scripts/entities/NPC.gd" id="1_npc"]
[ext_resource type="Script" uid="uid://l6yo2itr4lnf" path="res://addons/utility_ai/agent/agent.gd" id="2_utility_agent"]
[ext_resource type="Script" uid="uid://cb0wlxa658a0p" path="res://scripts/ai/actions/action_bt_wrapper.gd" id="3_action_wrapper"]
[ext_resource type="PackedScene" path="res://scripts/ai/bt/trees/social_interact_bt.tscn" id="4_social_bt"]
[ext_resource type="Script" uid="uid://jlwpenqxgq3l" path="res://scripts/ai/considerations/social_desire.gd" id="5_social_desire"]
[ext_resource type="PackedScene" path="res://scripts/ai/bt/trees/idle_wander_bt.tscn" id="6_idle_bt"]
[ext_resource type="Script" uid="uid://blk31okmdul67" path="res://scripts/ai/considerations/fixed_score.gd" id="7_fixed_score"]
[ext_resource type="Texture2D" uid="uid://dhxl0pg5gubkl" path="res://example_ai/assets/forestSprites_ v1.2/gnome_.png" id="8_bycv4"]
[ext_resource type="Texture2D" uid="uid://m4umb36tgrxl" path="res://example_ai/assets/forest_/forest_ [resources].png" id="9_t7167"]
[ext_resource type="Script" uid="uid://dp81q3571l76p" path="res://scripts/entities/SocialComponent.gd" id="10_social_comp"]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_body"]

[sub_resource type="ImageTexture" id="ImageTexture_3egug"]

[sub_resource type="CircleShape2D" id="CircleShape2D_interaction"]
radius = 73.0

[sub_resource type="Curve" id="Curve_cmg02"]
_data = [Vector2(0, 0.9405035), 0.0, 0.0, 0, 0, Vector2(0.66386557, 0.025743723), 0.0, 0.0, 0, 0, Vector2(0.9187675, 0.48684216), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="Curve" id="Curve_t7167"]

[sub_resource type="AtlasTexture" id="AtlasTexture_vtitq"]
atlas = ExtResource("8_bycv4")
region = Rect2(24, 0, 24, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_b6fol"]
atlas = ExtResource("8_bycv4")
region = Rect2(24, 96, 24, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_s66ib"]
atlas = ExtResource("8_bycv4")
region = Rect2(0, 0, 24, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_jy45v"]
atlas = ExtResource("8_bycv4")
region = Rect2(24, 0, 24, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_nbmr3"]
atlas = ExtResource("8_bycv4")
region = Rect2(0, 48, 24, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_426uu"]
atlas = ExtResource("8_bycv4")
region = Rect2(24, 48, 24, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_ywfx4"]
atlas = ExtResource("8_bycv4")
region = Rect2(48, 48, 24, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_8xi4t"]
atlas = ExtResource("8_bycv4")
region = Rect2(72, 48, 24, 24)

[sub_resource type="AtlasTexture" id="AtlasTexture_sft02"]
atlas = ExtResource("8_bycv4")
region = Rect2(72, 120, 24, 24)

[sub_resource type="SpriteFrames" id="SpriteFrames_3j6ye"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_vtitq")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_b6fol")
}],
"loop": true,
"name": &"eat",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_s66ib")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_jy45v")
}],
"loop": true,
"name": &"idle",
"speed": 3.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_nbmr3")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_426uu")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ywfx4")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_8xi4t")
}],
"loop": true,
"name": &"run",
"speed": 8.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_sft02")
}],
"loop": true,
"name": &"sleep",
"speed": 5.0
}]

[node name="NPC" type="CharacterBody2D" groups=["npc"]]
collision_layer = 2
script = ExtResource("1_npc")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, -15)
shape = SubResource("CapsuleShape2D_body")

[node name="Sprite2D" type="Sprite2D" parent="."]
visible = false
position = Vector2(-8, -20)
scale = Vector2(16, 20)
texture = SubResource("ImageTexture_3egug")

[node name="InteractionZone" type="Area2D" parent="."]
position = Vector2(0, -11)
collision_layer = 0
collision_mask = 2
monitorable = false

[node name="CollisionShape2D" type="CollisionShape2D" parent="InteractionZone"]
position = Vector2(0, -3)
shape = SubResource("CircleShape2D_interaction")
debug_color = Color(0.7, 0.5, 0, 0.42)

[node name="UtilityAiAgent" type="Node" parent="."]
script = ExtResource("2_utility_agent")
auto_execute_actions = true

[node name="ActionSocialInteract" type="Node" parent="UtilityAiAgent"]
script = ExtResource("3_action_wrapper")
bt_scene = ExtResource("4_social_bt")
cooldown = 5.0


[node name="SocialDesire" type="Node" parent="UtilityAiAgent/ActionSocialInteract"]
script = ExtResource("5_social_desire")
curve = SubResource("Curve_cmg02")

[node name="ActionIdleWander" type="Node" parent="UtilityAiAgent"]
script = ExtResource("3_action_wrapper")
bt_scene = ExtResource("6_idle_bt")

[node name="FixedScore" type="Node" parent="UtilityAiAgent/ActionIdleWander"]
script = ExtResource("7_fixed_score")
curve = SubResource("Curve_t7167")

[node name="SocialComponent" type="Node" parent="."]
script = ExtResource("10_social_comp")

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="."]

[node name="body" type="AnimatedSprite2D" parent="."]
position = Vector2(0, -12)
sprite_frames = SubResource("SpriteFrames_3j6ye")
animation = &"eat"
autoplay = "idle"

[node name="mushroom" type="Sprite2D" parent="body"]
visible = false
position = Vector2(0, 8)
texture = ExtResource("9_t7167")
region_enabled = true
region_rect = Rect2(147, 18, 6, 7)
